{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/details/macro.njk" import govukDetails %}

{% extends "form-template.njk" %}
{% set hmpoPageKey = "check" %}

{% block mainContent %}
<h1 id="header">{{translate("pages.check.title")}} </h1>
{% call hmpoForm(ctx) %}

<p>We need to check your details against information held by another company.</p>

<p>This will help us protect you against online identity theft.</p>

<details class="govuk-details" data-module="govuk-details">
    <summary class="govuk-details__summary">
        <span class="govuk-details__summary-text">Who we check your details with</span>
    </summary>
    <div class="govuk-details__text">
        <p>We'll check your details with <a href="https://www.experian.co.uk/" class="govuk-link" rel="noreferrer noopener" target="_blank">Experian (opens in new tab)</a>. This is because companies like Experian have access to information about interactions you've previously had with other organisations.</p>

        <p><a href="https://signin.account.gov.uk/privacy-notice" class="govuk-link" rel="noreferrer noopener" target="_blank">Read our privacy notice (opens in new tab)</a> if you'd like to know more about how your details will be used to prove your identity.</p>
    </div>
</details>

<button id="button2" class="govuk-button govuk-visually-hidden" data-module="govuk-button">Continue</button>
<!--

<button class="govuk-button govuk-!-margin-top-4" id="button--save" data-module="govuk-button" >Continue</button>
-->
{{ hmpoSubmit(ctx, {text: translate("buttons.next")}) }}

<script type="text/javascript">
    submitSpinner()

    function buttonClicked(target) {
        target.setAttribute('disabled', 'disabled')
        target.className += ' button--save'
        setTimeout(function () {
            document.getElementById('button2').click()
        }, 2000)
    }

    function submitSpinner() {
        //var selects = document.getElementById('button--save')
        var selects = document.getElementById('hmpoSubmit')
        selects.addEventListener('click', function (event) {
            event.preventDefault()
            if (selects.getAttribute('disabled') === 'disabled') {
                console.log('already clicked')
            } else {
                event.preventDefault()
                console.log(selects.getAttribute('disabled'))
                buttonClicked(selects)
            }
        })
    }
</script>

{% endcall %}
{% endblock %}
